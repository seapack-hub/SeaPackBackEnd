<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.seaPack.mapper.FundBaseInfoMapper">
  <resultMap id="BaseResultMap" type="org.seaPack.model.FundBaseInfo">
    <id column="fund_code" jdbcType="VARCHAR" property="fundCode" />
    <result column="fund_name" jdbcType="VARCHAR" property="fundName" />
    <result column="fund_full_name" jdbcType="VARCHAR" property="fundFullName" />
    <result column="fund_type" jdbcType="VARCHAR" property="fundType" />
    <result column="fund_type_name" jdbcType="VARCHAR" property="fundTypeName" />
    <result column="management_company" jdbcType="VARCHAR" property="managementCompany" />
    <result column="custodian" jdbcType="VARCHAR" property="custodian" />
    <result column="incept_date" jdbcType="VARCHAR" property="inceptDate" />
    <result column="issue_share" jdbcType="DECIMAL" property="issueShare" />
    <result column="m_fee" jdbcType="DECIMAL" property="mFee" />
    <result column="c_fee" jdbcType="DECIMAL" property="cFee" />
    <result column="s_fee" jdbcType="DECIMAL" property="sFee" />
    <result column="latest_asset_size" jdbcType="DECIMAL" property="latestAssetSize" />
    <result column="status" jdbcType="VARCHAR" property="status" />
    <result column="created_at" jdbcType="TIMESTAMP" property="createdAt" />
    <result column="updated_at" jdbcType="TIMESTAMP" property="updatedAt" />
  </resultMap>

  <!--查询基金信息列表-->
  <select id="selectFundsList" parameterType="org.seaPack.model.FundBaseInfo" resultMap="BaseResultMap">
    select
    f.fund_code,
    f.fund_name,
    f.fund_full_name,
    f.fund_type,
    d.dict_name as fund_type_name,
    f.management_company,
    f.custodian,
    f.incept_date,
    f.issue_share,
    f.m_fee,
    f.c_fee,
    f.s_fee,
    f.latest_asset_size,
    f.status,
    f.created_at,
    f.updated_at
    from fund_base_info f
    left join sys_dict d on f.fund_type = d.dict_code and d.dict_type = "fund_type"
    <where>
      <if test="keywords != null and keywords != ''">
        AND (fund_name LIKE CONCAT('%', #{keywords}, '%') OR fund_code LIKE CONCAT('%', #{keywords}, '%'))
      </if>
    </where>
    order by f.incept_date DESC
  </select>

  <!--插入基金信息表-->
  <insert id="insertFundBaseInfo" parameterType="org.seaPack.model.FundBaseInfo">
    insert into fund_base_info
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="fundCode != null">fund_code,</if>
      <if test="fundName != null">fund_name,</if>
      <if test="fundFullName != null">fund_full_name,</if>
      <if test="fundType != null">fund_type,</if>
      <if test="managementCompany != null">management_company,</if>
      <if test="custodian != null">custodian,</if>
      <if test="inceptDate != null">incept_date,</if>
      <if test="issueShare != null">issue_share,</if>
      <if test="mFee != null">m_fee,</if>
      <if test="cFee != null">c_fee,</if>
      <if test="sFee != null">s_fee,</if>
      <if test="latestAssetSize != null">latest_asset_size,</if>
      <if test="status != null">status,</if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="fundCode != null">#{fundCode},</if>
      <if test="fundName != null">#{fundName},</if>
      <if test="fundFullName != null">#{fundFullName},</if>
      <if test="fundType != null">#{fundType},</if>
      <if test="managementCompany != null">#{managementCompany},</if>
      <if test="custodian != null">#{custodian},</if>
      <if test="inceptDate != null">#{inceptDate},</if>
      <if test="issueShare != null">#{issueShare},</if>
      <if test="mFee != null">#{mFee},</if>
      <if test="cFee != null">#{cFee},</if>
      <if test="sFee != null">#{sFee},</if>
      <if test="latestAssetSize != null">#{latestAssetSize},</if>
      <if test="status != null">#{status},</if>
    </trim>
  </insert>

  <!--更新基金信息-->
  <update id="updateFundBaseInfo" parameterType="org.seaPack.model.FundBaseInfo">
    update fund_base_info
    <set>
      <if test="fundName != null">fund_name = #{fundName},</if>
      <if test="fundFullName != null">fund_full_name = #{fundFullName},</if>
      <if test="fundType != null">fund_type = #{fundType},</if>
      <if test="managementCompany != null">management_company = #{managementCompany},</if>
      <if test="custodian != null">custodian = #{custodian},</if>
      <if test="inceptDate != null">incept_date = #{inceptDate},</if>
      <if test="issueShare != null">issue_share = #{issueShare},</if>
      <if test="mFee != null">m_fee = #{mFee},</if>
      <if test="cFee != null">c_fee = #{cFee},</if>
      <if test="sFee != null">s_fee = #{sFee},</if>
      <if test="latestAssetSize != null">latest_asset_size = #{latestAssetSize},</if>
      <if test="status != null">status = #{status},</if>
      updated_at = NOW()
    </set>
    where fund_code = #{fundCode}
  </update>

  <!--根据fundCode查询信息(Count)-->
  <select id="selectFundBaseInfoByCode" parameterType="org.seaPack.model.FundBaseInfo" resultType="java.lang.Integer">
    select count(*) from fund_base_info
    <where>
      <if test="fundCode != null and fundCode != ''">
        AND fund_code = #{fundCode}
      </if>
    </where>
  </select>

  <!--根据fundCode查询详情-->
  <select id="selectFundDetailByCode" parameterType="java.lang.String" resultMap="BaseResultMap">
    select
    f.fund_code,
    f.fund_name,
    f.fund_full_name,
    f.fund_type,
    d.dict_name as fund_type_name,
    f.management_company,
    f.custodian,
    f.incept_date,
    f.issue_share,
    f.m_fee,
    f.c_fee,
    f.s_fee,
    f.latest_asset_size,
    f.status,
    f.created_at,
    f.updated_at
    from fund_base_info f
    left join sys_dict d on f.fund_type = d.dict_code and d.dict_type = "fund_type"
    where f.fund_code = #{fundCode}
  </select>

  <delete id="deleteFundBaseInfoByCode" parameterType="java.lang.String">
    delete from fund_base_info
    where fund_code = #{fundCode}
  </delete>

</mapper>
